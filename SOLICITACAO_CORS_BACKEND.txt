SOLICITAÇÃO DE CONFIGURAÇÃO DE CORS - BACKEND SPRING BOOT
=========================================================

Olá equipe de backend,

Estamos com um problema de CORS ao tentar fazer login do painel administrativo.

ERRO ATUAL:
-----------
Pedido de origem cruzada bloqueado: A política de mesma origem não permite a leitura 
do recurso remoto em http://localhost:8080/api/auth/login. 
(Motivo: pedido CORS não foi bem sucedido). Código de estado: (null).

CAUSA:
------
O backend Spring Boot não está aceitando requisições do frontend rodando em:
- http://localhost:3000 (desenvolvimento local)

SOLUÇÃO NECESSÁRIA:
-------------------
Por favor, configurar CORS no backend para aceitar as seguintes origens:

1. http://localhost:3000 (desenvolvimento local)
2. https://admin.gdse.ao (produção)

CÓDIGO PARA ADICIONAR NO BACKEND:
----------------------------------

Criar ou atualizar a classe de configuração CORS:

```java
package ao.gdse.api.config;

import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.CorsRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

@Configuration
public class CorsConfig implements WebMvcConfigurer {
    
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**")
            .allowedOrigins(
                "http://localhost:3000",      // Desenvolvimento local
                "https://admin.gdse.ao"        // Produção
            )
            .allowedMethods("GET", "POST", "PUT", "DELETE", "OPTIONS", "PATCH")
            .allowedHeaders("*")
            .allowCredentials(true)           // IMPORTANTE: Para enviar cookies de sessão
            .maxAge(3600);
    }
}
```

ALTERNATIVA (Se usar Spring Security):
---------------------------------------

Se o projeto usa Spring Security, adicionar esta configuração na classe SecurityConfig:

```java
@Bean
public CorsConfigurationSource corsConfigurationSource() {
    CorsConfiguration configuration = new CorsConfiguration();
    configuration.setAllowedOrigins(Arrays.asList(
        "http://localhost:3000",
        "https://admin.gdse.ao"
    ));
    configuration.setAllowedMethods(Arrays.asList("GET", "POST", "PUT", "DELETE", "OPTIONS", "PATCH"));
    configuration.setAllowedHeaders(Arrays.asList("*"));
    configuration.setAllowCredentials(true);
    configuration.setMaxAge(3600L);
    
    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
    source.registerCorsConfiguration("/**", configuration);
    return source;
}
```

E adicionar `.cors(cors -> cors.configurationSource(corsConfigurationSource()))` na cadeia de segurança.

PONTOS IMPORTANTES:
-------------------
1. allowCredentials(true) é OBRIGATÓRIO porque usamos autenticação baseada em sessão (cookies)
2. allowedOrigins deve incluir EXATAMENTE as URLs do frontend (protocolo + domínio + porta)
3. Após adicionar a configuração, reiniciar o servidor backend
4. Verificar se não há outra configuração de CORS que possa estar conflitando

TESTE APÓS CONFIGURAÇÃO:
-------------------------
1. Reiniciar o backend
2. Tentar fazer login no painel: http://localhost:3000/login
3. Verificar console do navegador - não deve aparecer erro de CORS

REFERÊNCIAS:
------------
- Documentação Spring CORS: https://spring.io/guides/gs/rest-service-cors
- Spring Security CORS: https://docs.spring.io/spring-security/reference/servlet/integrations/cors.html

CONTATO:
--------
Se houver dúvidas ou problemas na implementação, favor nos informar.

Att,
Equipe Frontend
Data: 02/01/2026
